<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¾Šç¾Šå°ˆè»Š VIP ä¸‹å–®ç³»çµ±</title>
    <style>
        :root { 
            --bg: #fffdf2; 
            --active-time: #ffd600; 
            --active-price: #d1c4e9; 
            --accent: #ff7043; 
            --main-green: #e8f5e9; 
        }
        body { 
            font-family: "Microsoft JhengHei", sans-serif; 
            background-color: var(--bg); 
            margin: 0; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
        }
        .card { 
            width: 100%; 
            max-width: 400px; 
            background: white; 
            border-radius: 40px; 
            padding: 30px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.1); 
            text-align: center; 
            box-sizing: border-box; 
        }
        .badge { 
            background: #ffd54f; 
            color: #5d4037; 
            padding: 5px 15px; 
            border-radius: 50px; 
            font-weight: bold; 
            font-size: 0.85rem; 
            display: inline-block; 
            margin-bottom: 10px; 
        }
        h1 { color: #2e7d32; margin: 10px 0; font-size: 1.8rem; }
        .slogan { color: #666; font-size: 0.9rem; margin-bottom: 20px; }
        
        .section-title { text-align: left; font-weight: bold; color: #388e3c; margin: 20px 0 10px 10px; }
        
        .item-table { width: 100%; border-collapse: separate; border-spacing: 0 10px; }
        .item-table td { 
            background-color: var(--main-green); 
            padding: 18px; 
            border-radius: 20px; 
            font-size: 1.25rem; 
            font-weight: bold; 
            cursor: pointer; 
            color: #2e7d32; 
            border: 3px solid transparent; 
            transition: 0.3s; 
        }
        
        /* é¸ä¸­ç‹€æ…‹é¡è‰² */
        .time-row.selected td { background-color: var(--active-time); color: #000; border-color: #fbc02d; }
        .price-row.selected td { background-color: var(--active-price); color: #311b92; border-color: #7e57c2; }
        
        .summary { 
            margin-top: 25px; 
            padding: 20px; 
            background: #fafafa; 
            border-radius: 30px; 
            border: 2px dashed #ddd; 
        }
        .total-text { font-size: 2.5rem; font-weight: 900; color: #d84315; }
        
        .submit-btn { 
            width: 100%; 
            margin-top: 25px; 
            padding: 22px; 
            border-radius: 25px; 
            border: none; 
            background-color: #ddd; 
            color: white; 
            font-size: 1.5rem; 
            font-weight: 900; 
            cursor: not-allowed; 
            transition: 0.3s;
        }
        .submit-btn.ready { 
            background-color: var(--accent); 
            cursor: pointer; 
            box-shadow: 0 10px 25px rgba(255,112,67,0.3); 
        }
        .submit-btn.ready:active { transform: scale(0.95); }

        /* å®Œæˆå‹•ç•«å±¤ */
        .overlay { 
            display: none; 
            position: fixed; 
            top: 0; left: 0; width: 100%; height: 100%; 
            background: white; 
            z-index: 1000; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            text-align: center; 
        }
        .sheep { font-size: 100px; animation: jump 0.4s infinite alternate; }
        @keyframes jump { from { transform: translateY(0); } to { transform: translateY(-30px); } }
    </style>
</head>
<body>

    <div class="card">
        <div class="badge">ä»Šæ—¥é™å®š VIP</div>
        <h1>ğŸ‘ ç¾Šç¾Šå°ˆè»Š</h1>
        <div class="slogan">ç¾Šå‘³åè¶³ãƒ»é†’è…¦æç¥<br>ä¿è­‰ä¸æšˆè»Šçš„å°ˆå±¬æœå‹™</div>

        <div class="section-title">ğŸ•’ ç¬¬ä¸€æ­¥ï¼šé¸æ“‡é ç´„æ™‚é–“</div>
        <table class="item-table">
            <tr class="time-row" onclick="selectTime(this,'19:00')"><td>19:00</td></tr>
            <tr class="time-row" onclick="selectTime(this,'20:00')"><td>20:00</td></tr>
            <tr class="time-row" onclick="selectTime(this,'20:30')"><td>20:30</td></tr>
            <tr class="time-row" onclick="selectTime(this,'21:00')"><td>21:00</td></tr>
            <tr class="time-row" onclick="selectTime(this,'21:30')"><td>21:30</td></tr>
        </table>

        <div class="section-title">ğŸ’° ç¬¬äºŒæ­¥ï¼šé¸æ“‡æœå‹™é …ç›®</div>
        <table class="item-table">
            <tr class="price-row" id="p1" onclick="selectPrice('p1', 90, 'å–®è¶Ÿ')"><td>å–®è¶Ÿ 90 å…ƒ</td></tr>
            <tr class="price-row" id="p2" onclick="selectPrice('p2', 10, 'å®‰å…¨å¸½')"><td>å®‰å…¨å¸½ 10 å…ƒ</td></tr>
        </table>

        <div class="summary">
            <div id="display-time" style="font-weight: bold; color: #666;">å°šæœªé¸æ“‡æ™‚é–“</div>
            <div class="total-text" id="display-price">$0</div>
        </div>

        <button class="submit-btn" id="submit-btn" onclick="handleSubmit()">ç¢ºå®šä¸‹å–®</button>
    </div>

    <!-- å®Œæˆç•«é¢ -->
    <div id="finish-overlay" class="overlay">
        <div class="sheep">ğŸ‘</div>
        <h2 style="color: #2e7d32;">ä¸‹å–®å®Œæˆï¼</h2>
        <p>æ­£åœ¨é€šçŸ¥ç¾Šç¾Šä¸¦é–‹å•Ÿ Line...</p>
    </div>

    <script>
        let selectedTime = "";
        let selectedItems = new Map();
        let totalPrice = 0;

        function selectTime(element, time) {
            document.querySelectorAll('.time-row').forEach(row => row.classList.remove('selected'));
            element.classList.add('selected');
            selectedTime = time;
            document.getElementById('display-time').innerText = "é ç´„æ™‚æ®µï¼š" + time;
            validate();
        }

        function selectPrice(id, price, name) {
            const element = document.getElementById(id);
            if (selectedItems.has(name)) {
                selectedItems.delete(name);
                element.classList.remove('selected');
            } else {
                selectedItems.set(name, price);
                element.classList.add('selected');
            }
            
            totalPrice = 0;
            selectedItems.forEach(value => totalPrice += value);
            document.getElementById('display-price').innerText = "$" + totalPrice;
            validate();
        }

        function validate() {
            const btn = document.getElementById('submit-btn');
            if (selectedTime !== "" && totalPrice > 0) {
                btn.classList.add('ready');
            } else {
                btn.classList.remove('ready');
            }
        }

        function handleSubmit() {
            if (selectedTime === "" || totalPrice === 0) return;

            // é¡¯ç¤ºå‹•ç•«
            document.getElementById('finish-overlay').style.display = 'flex';

            // 1. å‚³é€åˆ° Google è¡¨å–® (èƒŒæ™¯å‚³é€)
            const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSdL5_1DV1sG9GcewsuTF9HJgeXhmDIm5KWzvG4-VejOOgz5Rw/formResponse";
            const formData = new URLSearchParams();
            formData.append("entry.2087055550", selectedTime);
            formData.append("entry.1589631620", Array.from(selectedItems.keys()).join('ã€') + " (ç¸½é¡ $" + totalPrice + ")");

            fetch(formUrl, {
                method: 'POST',
                mode: 'no-cors',
                body: formData
            });

            // 2. å»¶é²ä¸€ä¸‹å¾Œè·³è½‰åˆ° Line è¨Šæ¯
            setTimeout(() => {
                const lineMsg = `ã€ğŸ‘ ç¾Šç¾Šå°ˆè»Šè¨‚å–®ã€‘\né ç´„æ™‚é–“ï¼š${selectedTime}\næœå‹™é …ç›®ï¼š${Array.from(selectedItems.keys()).join('ã€')}\nåˆè¨ˆé‡‘é¡ï¼š$${totalPrice}`;
                window.location.href = `https://line.me/R/msg/text/?${encodeURIComponent(lineMsg)}`;
            }, 2000);
        }
    </script>
</body>
</html>